<div class="login-container">
  <background></background>
  <div class="login-card">
    <h1 class="login-title">TRIVIA WAR</h1>
    <p class="login-subtitle">Juego de trivia<br>Desaf√≠o grupal</p>
    
    @if (showSuccess()) {
      <div class="success-message">
        <div class="success-icon">‚ú®</div>
        <p class="success-title">Usuario Registrado Correctamente</p>
        <small class="success-text">Tu cuenta ha sido verificada exitosamente</small>
        <div class="success-loader"></div>
        <small class="redirect-text">Redirigiendo al login...</small>
      </div>
    } @else if (showConfirmation()) {
      <div class="confirmation-form">
        <h2 class="confirmation-title">‚úâÔ∏è Confirma tu cuenta</h2>
        <p class="confirmation-text">Hemos enviado un c√≥digo a <strong>{{ pendingEmail() }}</strong></p>
        
        @if (errorMessage()) {
          <div class="error-message">{{ errorMessage() }}</div>
        }
        
        <div class="form-group">
          <input 
            type="text"
            placeholder="C√≥digo de confirmaci√≥n"
            class="form-input" 
            [value]="confirmationCode()"
            (input)="onConfirmationCodeChange($event.target.value)"
            [disabled]="isLoading()"
            required>
        </div>
        
        <button 
          type="button" 
          class="login-button"
          (click)="confirmSignUp()"
          [disabled]="isLoading() || !confirmationCode()"
          [class.loading]="isLoading()">
          @if (isLoading()) {
            <span class="loading-spinner"></span>
            Confirmando...
          } @else {
            Confirmar Cuenta
          }
        </button>
        
        <div class="resend-section">
          <a href="#" class="resend-link" (click)="resendCode(); $event.preventDefault()">
            ¬øNo recibiste el c√≥digo? Reenviar
          </a>
        </div>
      </div>
    } @else {
      <form class="login-form" (ngSubmit)="onSubmit()">
        @if (errorMessage()) {
          <div class="error-message">{{ errorMessage() }}</div>
        }
      
        @if (isSignUpMode()) {
          <div class="form-group">
            <input 
              type="text"
              placeholder="Nombre de jugador"
              class="form-input" 
              [value]="name()"
              (input)="onNameChange($event.target.value)"
              [disabled]="isLoading()"
              required>
          </div>
        }

        <div class="form-group">
          <input 
            type="email"
            placeholder="Email"
            class="form-input" 
            [value]="email()"
            (input)="onEmailChange($event.target.value)"
            [disabled]="isLoading()"
            required>
        </div>
        
        <div class="form-group">
          <input 
            type="password" 
            placeholder="Contrase√±a" 
            class="form-input" 
            [value]="password()"
            (input)="onPasswordChange($event.target.value)"
            [disabled]="isLoading()"
            required>
        </div>

        @if (isSignUpMode()) {
          <div class="form-group">
            <input 
              type="password" 
              placeholder="Confirmar contrase√±a" 
              class="form-input" 
              [class.error]="!passwordsMatch()"
              [value]="confirmPassword()"
              (input)="onConfirmPasswordChange($event.target.value)"
              [disabled]="isLoading()"
              required>
          </div>
          @if (!passwordsMatch() && confirmPassword()) {
            <div class="password-error">Las contrase√±as no coinciden</div>
          }
        }
        
        <button 
          type="submit" 
          class="login-button"
          [disabled]="isLoading() || !email() || !password() || (isSignUpMode() && (!name() || !confirmPassword() || !passwordsMatch()))"
          [class.loading]="isLoading()">
          @if (isLoading()) {
            <span class="loading-spinner"></span>
            @if (isSignUpMode()) {
              Registrando...
            } @else {
              Ingresando...
            }
          } @else {
            @if (isSignUpMode()) {
              Crear Cuenta
            } @else {
              Ingresar
            }
          }
        </button>
      </form>
      
      <div class="toggle-mode">
        <a href="#" class="toggle-link" (click)="toggleMode(); $event.preventDefault()">
          @if (isSignUpMode()) {
            ¬øYa tienes cuenta? Inicia sesi√≥n
          } @else {
            ¬øNo tienes cuenta? Reg√≠strate
          }
        </a>
      </div>

      @if (isSignUpMode()) {
        <div class="password-requirements">
          <small>üéÆ Requisitos: M√≠nimo 6 caracteres, 1 min√∫scula y 1 n√∫mero</small>
        </div>
      }
      
      <div class="login-hint">
        <small>Autenticaci√≥n integrada con AWS Cognito</small>
      </div>
    }
  </div>
</div>